# Задание 4

**Этапы решения задания**

(Везде в осинт части будет фигурировать никнейм Gustav0kXak)

1. Скачав .zip архив по ссылке из задания, участник разворачивает у себя на машине с помощью VMware полученную из архива ВМ.
2. Развернув ВМ, он понимает, что пароля к ВМ не было выдано. Следовательно, пароль необходимо сбросить любым возможным способом. Например, вот так: [https://losst.pro/sbros-parolya-ubuntu](https://vk.com/away.php?to=https%3A%2F%2Flosst.pro%2Fsbros-parolya-ubuntu&cc_key=) (Сброс с помощью Grub).
3. Сбросив пароль к ВМ, участник попадает в домашнюю директорию пользователя, которая содержит файл picture.txt. Воспользовавшись утилитой file, участник понимает, что это картинка. Просмотрев картинку, можно увидеть две подсказки. Первая это цитата, которая явно отсылает к Event Log (Журналу событий) в Windows. Вторая это автор цитаты. Автор цитаты – никнейм злого хакера из задания, который участник будет использовать в дальнейшем для поиска ключа для расшифрования файла. Так же, если применить к файлу с картинкой утилиту strings, можно получить подсказку о том, что смотреть необходимо в директории /var/log/.
4. Исследуя дампы логов событий, которые содержатся в директории /var/log/event-log/, участник находит сообщение, которое было сгенерировано каким-то приложением, написанным на java. Текст сообщения: «Bill, I don't have much time to convey this message and I need to say a very important and secret thing. F1@g in encrypted application, it is located in "proj3c1s" directory. I left the key for the decrypting somewhere on the Internet in a profile with link that matches my nickname. It is my profile from "Worldwide catalog of ideas" (This words should be in Russian) <т.е. Всемирный каталог идей>. Don't count on me, because the cops are already after me». Чтобы его найти, можно воспользоваться подсказкой из текста задания и произвести поиск в тексте по ключевому слову Bill. В сообщении говорится:1) о директории, в которой лежит это приложение;2) о том, что ключ к диску оставлен где-то в Интернете, ведь профиль злого хакера точно совпадает с его никнеймом. А также то, что это профиль из соц. сети «всемирного каталога идей» (Pinterest);3) о том, что флаг расположен где-то внутри зашифрованного приложения.
5. Найти файл приложения по названию директории /proj3c1s/ из прошлой подсказки можно с помощью команды sudo find / -type d -name “proj3c1s”. Воспользовавшись утилитой file, участник узнает, что файл был зашифрован с помощью openssl. Вспомнив про подсказку из прошлого пункта, участник отправляется искать ключ в интернете.
6. Вспомнив про «всемирный каталог идей», участник делает вывод о том, что речь идет про сервис pinterest (это можно узнать, загуглив словосочетание «всемирный каталог идей»).
7. Итак, участник имеет две подсказки: pinterest и никнейм из пункта 3. Проверив, как формируются ссылки на профили в данной соц. сети и вспомнив про подсказку из п.3 про ссылку на профиль, участник формирует ссылку [https://ru.pinterest.com/Gustav0kXak/](https://vk.com/away.php?to=https%3A%2F%2Fru.pinterest.com%2FGustav0kXak%2F&cc_key=) и попадает на страницу злого хакера.Особенностью данной соц. сети является то, что каждый пост и фотография в нем привязываются к конкретной ссылке в сети Интернет.Проверив все посты, участник обнаружит, что только 1 ведет на сторонний сайт, который похож на персональный блог злого хакера. ([https://cz59731.tw1.ru/](https://vk.com/away.php?to=https%3A%2F%2Fcz59731.tw1.ru%2F&cc_key=))
8. Исследуя данный сайт и его html-код, участник обнаруживает, что фотография на одном из постов в блоге ведет на дополнительную страницу, на которой написано, что ключ участник просто так не получит. Однако, открыв исходный код данной страницы, участник обнаружит скрытый элемент, в котором как раз будет лежать ключ для расшифрования файла приложения. Также там оставлена подсказка, в которой упоминается, что алгоритм шифрования произошел от Rijndael. А ещё ключ в алгоритме составляет 256 бит. Погуглив, какой алгоритм шифрования имеет такие свойства, участник понимает, что речь идет про AES256. Так же, если в последнем предложении подсказки сопоставить все заглавные буквы вместе, то получится режим работы AES256 – CBC. Теперь участник знает полное название примененного алгоритма и утилиты для его применения (см. п. 5)
9. Расшифровав файл с помощью команды openssl enc -d -aes-256-cbc -in untitled -out <output_filename> и полученного ранее пароля, участник получает расшифрованный файл. Воспользовавшись утилитой file, он узнает, что это исполняемый .jar файл. Попытавшись запустить файл, участник видит просто приложение-пустышку, которое запрашивает ввод какого-то числа и возвращает это же число. Вспомнив про подсказку из логов событий (см. п. 4), участник понимает, что флаг находится где-то внутри приложения. Соответственно, необходимо произвести декомпилирование исполняемого .jar файла в .class файл с исходным кодом приложения.
10. Получив исходный код приложения, участник обнаруживает переменную firstPartFlag, которая зашифрована с помощью операции xor. Ключ расшифрования расположен в том же исходном коде. Таким образом, участник получает первую часть флага.
11. Т. к. это java-приложение, оно представляет собой .jar файл, который является архивом. Открыв файл с помощью архиватора, участник находит текстовый файл под названием part2fl, внутри которого лежит последовательность байт, представляющая собой вторую часть флага.
12. Произведя конкатенацию (т. е. соединение в единую строку) обеих частей флага, участник получает итоговый флаг: NQ2024565a56124b53690d38d2f2f9a2466466259cc2c0f569b812ce9705e6806502fa