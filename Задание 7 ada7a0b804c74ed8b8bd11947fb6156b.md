# Задание 7

Флаг: NQ20241be0eb8267faddd4f9f00dd8ab10959dc6b5285256df12047bf884ea3ebb8cc

Входные параметры: .pcap файл

1. Сначала смотрим на пакеты, изучаем структуруСможем заметить, что в пакетах ДЕЙСТВИТЕЛЬНО содержатся картинки:

![https://sun9-77.userapi.com/impg/0Pme3GVhB-HVG0JkBXi3lhrwZRxIeW-etSAjfw/GDlmvolmL1o.jpg?size=637x445&quality=95&sign=8fae46ce265d1b8c444c47b9fa76a32b&type=album](https://sun9-77.userapi.com/impg/0Pme3GVhB-HVG0JkBXi3lhrwZRxIeW-etSAjfw/GDlmvolmL1o.jpg?size=637x445&quality=95&sign=8fae46ce265d1b8c444c47b9fa76a32b&type=album)

1. Далее можем вытащить картинку из любого запроса, загрузить её значения в файлик. Получим непонятную картинку

![https://sun9-73.userapi.com/impg/9m8090CexOI6SQNIo5XQxSn5Rz161ZH7zp6nmw/VwId9etovfQ.jpg?size=420x387&quality=95&sign=a7ebab605008d3038b4767b405c2f918&type=album](https://sun9-73.userapi.com/impg/9m8090CexOI6SQNIo5XQxSn5Rz161ZH7zp6nmw/VwId9etovfQ.jpg?size=420x387&quality=95&sign=a7ebab605008d3038b4767b405c2f918&type=album)

1. Можем проверить ещё картинок, поймём, что все картинки выглядит вот так, одинаково
2. Попробуем смотреть по косвенным признакам. В ходе изучения отправляемых пакетов, можем посмотреть на куки, отправляемые в пакетах. Заметим, что у ~100 пакетов есть параметр:Cookie: you_need_this=false
3. Отсортируем пакеты по cookie и попробуем найти тот, у кого этот Cookie стоит в значение true
4. Находим единственный пакет:

![https://sun9-75.userapi.com/impg/O7MDU0NleRf1iZatNSfhQSuMZFWVdBlm7NeRIw/V_lA5QhdepQ.jpg?size=807x314&quality=95&sign=0140c1bd119c72db15784d839cbe27a1&type=album](https://sun9-75.userapi.com/impg/O7MDU0NleRf1iZatNSfhQSuMZFWVdBlm7NeRIw/V_lA5QhdepQ.jpg?size=807x314&quality=95&sign=0140c1bd119c72db15784d839cbe27a1&type=album)

1. В этом пакете видим, что отправленная картинка называется img586.jpg и выглядит вот так (если загрузить содержимое в файл):

![https://sun9-46.userapi.com/impg/0Qhsj--Okes0suxm2ktHUs2cd3fDbNp7d8lqYg/Km-ZfCpAZPk.jpg?size=302x231&quality=95&sign=ce52ee83bf5814e21f9825b76d5dcff0&type=album](https://sun9-46.userapi.com/impg/0Qhsj--Okes0suxm2ktHUs2cd3fDbNp7d8lqYg/Km-ZfCpAZPk.jpg?size=302x231&quality=95&sign=ce52ee83bf5814e21f9825b76d5dcff0&type=album)

1. Из картинки видно, что она достаточно маленькая и сжатая, однако её вес составляет ~586 килобайт, что слишком много для такой маленькой картинки.
2. Начав более подробно изучать файл можно заметить, что начиная с некоторого момента, в файле повторились заголовки JPG файла:

![https://sun9-59.userapi.com/impg/1ypefvoKWcPEMf1pzokQKLzAGhdnVKpZwGTUeQ/OPxvo3vRe1c.jpg?size=570x539&quality=95&sign=0f7d17ca52323fb0e395e95d05736a71&type=album](https://sun9-59.userapi.com/impg/1ypefvoKWcPEMf1pzokQKLzAGhdnVKpZwGTUeQ/OPxvo3vRe1c.jpg?size=570x539&quality=95&sign=0f7d17ca52323fb0e395e95d05736a71&type=album)

1. Скопировав содержимое ниже данного места, можно получить уже новую картинку, подозрительно расширенную:

![https://sun9-43.userapi.com/impg/X7Aw1zdJL8g8XaxqRDeZfDvC8gk-WMSMbR4xSw/Xg8aYmbrNfw.jpg?size=807x454&quality=95&sign=aff53f38c3a8703b0af5b64df0cfc537&type=album](https://sun9-43.userapi.com/impg/X7Aw1zdJL8g8XaxqRDeZfDvC8gk-WMSMbR4xSw/Xg8aYmbrNfw.jpg?size=807x454&quality=95&sign=aff53f38c3a8703b0af5b64df0cfc537&type=album)

1. Здесь можно обнаружить некий TG аккаунт, запечатлённый на скриншоте (также скрин из игры NeoQuest :)
2. Написав этому аккаунту в TG, можно выпытать нужный ключ!

![https://sun9-30.userapi.com/impg/dMFiYAkorgFAm4fbckdGagGaP85ZgdkbFUkY_A/8dToU-V89kM.jpg?size=622x256&quality=95&sign=e3681dc288ad38f661992e578a467bbe&type=album](https://sun9-30.userapi.com/impg/dMFiYAkorgFAm4fbckdGagGaP85ZgdkbFUkY_A/8dToU-V89kM.jpg?size=622x256&quality=95&sign=e3681dc288ad38f661992e578a467bbe&type=album)